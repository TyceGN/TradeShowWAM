<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Whack-a-Mole Game</title>
  <!-- Load Phaser from a CDN -->
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
  <style>
    body { margin: 0; }
  </style>
</head>
<body>
<script>
  class GameScene extends Phaser.Scene {
    constructor() {
      super({ key: 'GameScene' });
      this.score = 0;
      this.gameTime = 30; // 30-second timer
    }

    preload() {
      // Load your background and mole assets (update paths as needed)
      this.load.image('background', 'assets/background.png');
      this.load.image('mole', 'assets/mole.png');
    }

    create() {
      // Add the background centered on the canvas (assuming 800x600)
      this.add.image(400, 300, 'background');

      // Display the current score
      this.scoreText = this.add.text(16, 16, 'Score: 0', { fontSize: '32px', fill: '#fff' });

      // Display timer in top right
      this.timerText = this.add.text(650, 16, 'Time: ' + this.gameTime, { fontSize: '32px', fill: '#fff' });

      // Start timer countdown
      this.time.addEvent({
        delay: 1000,
        callback: () => {
          this.gameTime--;
          this.timerText.setText('Time: ' + this.gameTime);
          if (this.gameTime <= 0) {
            // End the game: stop mole spawns and show "Game Over"
            this.time.removeAllEvents();
            this.add.text(300, 300, 'Game Over!', { fontSize: '48px', fill: '#f00' });
          }
        },
        callbackScope: this,
        loop: true
      });

      // Create a group for moles
      this.moles = this.physics.add.group();

      // Spawn a mole every second
      this.time.addEvent({
        delay: 1000,
        callback: this.spawnMole,
        callbackScope: this,
        loop: true
      });
    }

    spawnMole() {
      // Fixed coordinates for the 9 holes
      const holePositions = [
        { x: 110, y: 506 },
        { x: 385, y: 506 },
        { x: 660, y: 506 },
        { x: 130, y: 362 },
        { x: 405, y: 362 },
        { x: 684, y: 362 },
        { x: 120, y: 252 },
        { x: 395, y: 252 },
        { x: 670, y: 252 }
      ];

      // Choose one random hole position
      const hole = Phaser.Math.RND.pick(holePositions);

      // Create a mole at the chosen position and set it interactive
      let mole = this.moles.create(hole.x, hole.y, 'mole').setInteractive();

      // Set the mole's origin to bottom center (0.5, 1) so its bottom aligns with the hole
      mole.setOrigin(0.5, 1);

      // When the mole is clicked/tapped, increase score and remove it
      mole.on('pointerdown', () => {
        mole.destroy();
        this.score += 10;
        this.scoreText.setText('Score: ' + this.score);
      });

      // Automatically remove the mole after 800ms if not tapped
      this.time.addEvent({
        delay: 800,
        callback: () => {
          if (mole.active) mole.destroy();
        },
        callbackScope: this
      });
    }
  }

  // Game configuration
const config = {
  type: Phaser.AUTO,
width: 800, // design width
  height: 600, // design height
  scale: {
    mode: Phaser.Scale.FIT,          // Scale the game to fit the window while preserving aspect ratio
    autoCenter: Phaser.Scale.CENTER_BOTH  // Center the game in the window
  },
  physics: {
    default: 'arcade',
    arcade: {
      debug: false
    }
  },
  scene: [GameScene]
};

  // Create the game instance
  const game = new Phaser.Game(config);
</script>
</body>
</html>
